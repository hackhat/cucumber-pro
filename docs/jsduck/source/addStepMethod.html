<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js"><span id='core-plugins-addStepMethod'>/**
</span> * @class core.plugins.addStepMethod
 * You can now call a step from another step.
 * Adds a `addStep` method to the test context. These
 * tests can later be called by the world with `callStep`.
 *
 * The `addStep` method now accept another extra argument. The first
 * one is the unique step name.
 *
 *     this.addStep(uniqueStepName, regexp, function);
 *
 * Example of steps definition:
 *
 *     // all.steps.js
 *     this.addStep('a', /^a$/, function(){
 *         console.log('a')
 *         this.callStep('b', 1);
 *     })
 *     this.addStep('b', /^b (\d+)$/, function(n){
 *         console.log('b', n)
 *     })
 *
 *     // test.feature
 *     Feature: Test
 *
 *     Scenario: Test
 *         Given a
 *         Given b 2
 *
 * Will log:
 *
 *     a    // From a called from the test.feature directly
 *     b 1  // From b but called by step a
 *     b 2  // From b called from the test.feature directly
 *
 *
 * @param {*} target The context of the test function which has the `.Given` methods.
 */
var addStepMethod = function(target){
    if(target.__steps) throw new Error('Target already has steps.')
    target.__steps = {};
    target.__addStep_origGiven = target.Given;
    var origGiven = target.Given;
    target.addStep = function(uniqueName, regexp, fn){
        target.__steps[uniqueName] = fn;
        this.__addStep_origGiven(regexp, fn);
    }.bind(target)
    target.getStep = function(uniqueName){
        return target.__steps[uniqueName];
    }
}





module.exports = addStepMethod;
</pre>
</body>
</html>
